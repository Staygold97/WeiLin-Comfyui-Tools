<div align="center">
  
### [🇨🇳 简体中文](README.md) | [🇺🇸 English](README_EN.md)

</div>

# 特别关注！
##### 一定要进群！一定要进群！一定要进群！
官方 QQ 群：`1018231382`

插件使用教程：[点击访问](https://www.bilibili.com/list/288025756/?sid=4690314&spm_id_from=333.1387.0.0&oid=114342431298474&bvid=BV1txdfYxE7X)
或者在B站搜索：WeiLin-Comfyui-Tools

# 注意！
##### 如果你需要使用或不了解又或者想要沟通交流都可以加入QQ群进行了解！
本插件还是在内测中，目前已经趋于稳定状态！如果要使用请进官方 QQ 群了解详情！

## 配套使用说明 - 旧插件提示词迁移到新插件
插件有专门的独立后台面板，可以把你的旧版的提示词转换成新版本插件的提示词以及便携式的离线修改Tag，项目入口 [WeiLin-Comfyui-Tools-panel
](https://github.com/weilin9999/WeiLin-Comfyui-Tools-panel)

## 插件的云Tag和Danbooru数据库仓库
仓库位置：[WeiLin-Comfyui-Tools-Prompt](https://github.com/weilin9999/WeiLin-Comfyui-Tools-Prompt)，如果你感兴趣可以查看一起协作

# 作者声明

由于个人时间有限，更新插件的频率并不会很高，偶尔有空或许会更新一次，每次更新尽量满足所提出的需求，一般没有大的 BUG 基本上更新频率不高，一个月 2~5 更，感谢你对本插件的使用与支持，有需求可以提交 Issue 或者你可以提交你的 Request 帮助本插件更新。

# 版本更新介绍

> 最新更新：2025-04-22

> 0.0.43 公测版本介绍 如果你要使用本插件请务必进我们的官方 QQ 群（1018231382）！
>
> 1. 修复了一些已知的BUG
>
> 2. 新增功能：批量导入Tag功能（修改了一些逻辑问题和优化一些新的功能）
>
> 3. 新增：记录输入框的高度，每次打开都会保持到上一次的状态高度
>

<details>
<summary>点击查看往期更多更新内容</summary>

> 0.0.42 公测版本介绍 2025-04-22
>
> 1. 修复了一些已知的BUG
>
> 2. 新增功能：批量导入Tag功能
>
> 3. 新增功能：分享Tag和批量分享的功能
>

> 0.0.41 公测版本介绍 2025-04-16
>
> 1. 修复了一些已知的BUG
>


> 0.0.40 公测版本介绍 2025-04-15
>
> 1. 修复了节点运行报错问题，修复了一些已知的BUG
>
> 2. 修改Lora堆节点，可以直接在节点操作Lora堆
>

> 0.0.38 公测版本介绍 2025-04-14
>
> 1. 修复了一些已知的BUG
>
> 2. 新增节点 仅Lora堆 节点
>
> 3. 优化Lora管理器，在UI主界面增加Lora管理器的快捷窗口
>
> 4. 在节点中增加了Lora堆的快捷按钮，点击即可直接显示节点的Lora堆信息可以快捷修改
>

> 0.0.37 公测版本介绍 2025-04-13
>
> 1. 修复了一些已知的BUG
>
> 2. 优化了Lora管理器卡顿问题
>
> 3. Lora详情中增加了基础模型显示和Lora Raw数据显示
>
> 4. 增加了Tag操作提示
>
> 5. 在悬浮球增加了图片转换功能
>

> 0.0.36 公测版本介绍 2025-04-08
>
> 1. 修复了一些已知的BUG
>
> 2. 优化了补全功能的精准度
>

> 0.0.35 公测版本介绍 2025-04-07
>
> 1. 新增功能可以隐藏Lora和隐藏Tag的功能，可以临时屏蔽你想要的Lora和Tag
>

> 0.0.34 公测版本介绍 2025-04-06
>
> 1. 修复了历史记录不会记录的问题
>

> 0.0.33 公测版本介绍 2025-04-04
>
> 1. 修复收藏和历史记录的请求错误问题
>

> 0.0.32 公测版本介绍 2025-04-03
>
> 1. **再次修复该问题-问题已被解决** 修复旧数据迁移不会将自己加的数据迁入问题，大家可以去```user_data_old```这个目录将数据文件名称修改成```userdatas_zh_CN.db```再返回文件夹```user_data```将该文件夹文件都删除，然后将修改名称为```userdatas_zh_CN.db```粘贴到此文件夹启动Comfyui即可再次迁移数据！
>


> 0.0.31 公测版本介绍 2025-04-02
>
> 1. 新增换行符显示，以及换行之后Tag显示也会跟着换行
>
> 2. 修复旧数据迁移不会将自己加的数据迁入问题，大家可以去```user_data_old```这个目录将数据文件名称修改成```userdatas_zh_CN.db```再返回文件夹```user_data```将该文件夹文件都删除，然后将修改名称为```userdatas_zh_CN.db```粘贴到此文件夹启动Comfyui即可再次迁移数据！
>

> 0.0.30 公测版本介绍 2025-04-01
>
> 1. 修复Tag在编辑的时候移动问题
>
> 2. 新增了云仓库！大家可以使用云仓库动态获取提示词或者更新Danbooru了，在UI界面“共享云数据”中打开！
>
> 3. 优化性能问题
>
> 4. 修复了一些已知的BUG

> 0.0.28 公测版本介绍 2025-03-31
>
> 1. 修改了全新的数据库拉取方式已经公开了仓库：[WeiLin-Comfyui-Tools-Prompt](https://github.com/weilin9999/WeiLin-Comfyui-Tools-Prompt)，有兴趣的伙伴可以查看怎么添加自己的tag或者danbooru
>
> 2. 优化了自动补全的功能

> 0.0.27 公测版本介绍 2025-03-30
>
> 1. 搜索Tag时有高亮，同时可以选择自动添加搜索的Tag到提示词中
>
> 2. 修改Lora详细页面中的提示词增加了隐藏和展开的功能
>
> 3. 修改Tag编辑的操作无处的方法，增加了一个编辑模式选择

> 0.0.26 公测版本介绍：2025-03-27
>
> 1. 修改了提示词默认自动加入逗号
>
> 2. 修改测试翻译错误的提示，以免误导
>
> 3. 隐藏Lora框，让节点更干净

> 0.0.24 2025-03-25 公测版本介绍
>
> 1. 在UI设置中添加了翻译库功能，可以替换三方翻译使用翻译库功能，需要安装翻译库点击安装即可，使用方便翻译功能完善 -- v0.0.23 2025-03-24
>
> 2. 新增节点：不加载Lora，此节点没有Lora的信息框可以减小节点的大小 -- v0.0.23 2025-03-24
>
> 3. 修复历史记录不记录问题，修改收藏的名称不显示的问题 -- v0.0.23 2025-03-24
>
> 4. 修复Lora堆最后一个不删除问题 -- v0.0.23 2025-03-24
>
> 5. 优化Tag过多导致翻译超时或获取本地数据超时的问题 -- v0.0.23 2025-03-24
>
> 6. 修复悬浮球会跳动问题 -- v0.0.23 2025-03-24
>
> 7. 调整：悬浮最小大小为6，大小上线999999，悬浮球最大个数上限调整至100 -- v0.0.23 2025-03-24
>
> 8. 修复在Comfyui版本v0.3.27中插件无法正常使用问题 -- v0.0.24 2025-03-25

> 0.0.20 2025-03-18 公测版本介绍
>
> 1.修复已知的BUG

> 0.0.19 2025-03-17 公测版本介绍
>
> 1.拆分节点提示词和Lora的文本，更加直观
>
>2.新增Lora支持搜索的功能，更快找到自己想要的Lora

> 0.0.18 2025-03-03 公测版本介绍
>
> 1.新增节点列表（悬浮球中打开），可以快捷打开本节点所有的Node，不需要再放大节点找


> 0.0.17 公测版本介绍 2025-02-22
>
> 1.修复权重添加会删除其它括号类型的BUG

> 0.0.16 2025-02-14 公测版本介绍
>
> 1.节点修改，新增了clip节点输出
>
> 2.节点修改，新增了string内容输入合并
>
> 3.修复了已知BUG
>
> 4.修改了Tag的控制栏的括号加减问题


> 0.0.15 公测版本介绍
>
> 1.节点修改，新增了clip节点输出
>
> 2.节点修改，新增了string内容输入合并


> 0.0.13 公测版本介绍
>
> 1.修复了已知 BUG
>
> 2.新增功能-Lora 支持一键缓存所有 Lora 文件
>
> 3.新增功能-支持加载 Lora 的时候同时加载对应的 Lora 提示词（需要给 Lora 设置提示词才可生效！）

> 0.0.12 公测版本介绍
>
> 1.修复了已知 BUG

> 0.0.0.3 内测版本介绍
>
> 1.更新了 AI 对话功能
>
> 2.更新了 Danbooru 词库到 2024-11-30
>
> 3.将所有 tag 和词库都写入到数据库中，我们不再使用 json 文件来存储我们的 tag 和词库，因为数据太多检索起来太慢了
>
> 4.优化了性能

> 0.0.0.1 版本介绍 （由于本人工作原因空闲时间才有时间更新插件，见谅！在此非常感谢大家对本插件的支持！）
>
> 1. 上传插件 0.0.0.1 版本

</details>

# 概要说明

本项目可以让你在 ComfyUI 中快捷的使用提示词工具
如果你对本项目有兴趣赏一个 Star 吧！

# 如何参与开发？

#### 项目主要结构
```
WeiLin-Comfyui-Tools 
├── README.md - 中文文档
├── README_EN.md - 英文文档
├── __init__.py - 插件主入口
├── app - 插件的业务代码（API、数据库操作等）
│   ├── __init__.py
│   └── server - 服务入口
│       ├── __pycache__
│       ├── ai_translator - AI设置业务层
│       ├── dao - 数据层操作
│       ├── fast_autocomplete - 补全功能业务层
│       ├── history - 历史记录业务层
│       ├── prompt_api - 提示词业务层
│       ├── prompt_server.py - API暴露入口
│       ├── translate - 本地/离线翻译Tag业务层
│       └── user_init - 用户设置初始化业务层
├── dist - 前端编译后的文件
├── init.json - AI服务的Key保存文件
├── install_request.py - 自动安装功能
├── js_node - comfyui的JS业务代码
├── lora_userdatas - 用户Lora的本地数据
├── pyproject.toml - comfyui的仓库文件
├── requirements.txt - 安装三方库检测文件
├── src - 前端源码
├── tags_templete 用户数据库文件模板 （Tag和Danbooru，如果需要修改请前往插件配套的后台面板使用）
└── user_data 用户使用的数据库文件（不需要修改）
```

#### 前端源码说明
前端框架是Vue3+Javascript，yarn管理依赖包，使用时请先执行`yarn install`安装依赖包，编译请使用`yarn run build`，会自动打包到插件的`dist`目录中

#### 提交代码
请克隆完整的仓库代码，提交代码时请测试一遍随后提交代码，等待我的审核确认后即可合并代码